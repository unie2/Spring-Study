## âœ” ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•
ìƒì„±ì ì£¼ì…, ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…), í•„ë“œ ì£¼ì…, ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

### 1. ìƒì„±ì ì£¼ì…
- `ìƒì„±ì`ë¥¼ í†µí•´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•
- ìƒì„±ìê°€ ë”± 1ê°œë§Œ ìˆìœ¼ë©´ `@Autowiredë¥¼ ìƒëµ`í•´ë„ `ìë™ ì£¼ì…` ëœë‹¤. (ë¬¼ë¡  ìŠ¤í”„ë§ ë¹ˆì—ë§Œ í•´ë‹¹)

#### íŠ¹ì§•
- ìƒì„±ì í˜¸ì¶œ ì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.
- `ë¶ˆë³€`, `í•„ìˆ˜` ì˜ì¡´ ê´€ê³„ì— ì‚¬ìš©

java > hello.core.order > OrderServiceImpl.java
````java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;
  
    @Autowired // ìƒì„±ìê°€ 1ê°œë§Œ ìˆìœ¼ë¯€ë¡œ @Autowired ìƒëµ ê°€ëŠ¥
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) { // ìƒì„±ì ì£¼ì…
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````

### 2. ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)
- í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œ(setter)ë¥¼ í†µí•´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•

#### íŠ¹ì§•
- `ì„ íƒ`, `ë³€ê²½` ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
- ìë°” ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

````java
@Component
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;
    
    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````
```
// ì°¸ê³  1
`@Autowired`ì˜ ê¸°ë³¸ ë™ì‘ì€ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´ `@Autowired(required = false)`ë¡œ ì§€ì •í•˜ë©´ ëœë‹¤.
// ì°¸ê³  2
ìë°” ë¹ˆ í”„ë¡œí¼í‹°, ìë°”ì—ì„œëŠ” ê³¼ê±°ë¶€í„° í•„ë“œì˜ ê°’ì„ ì§ì ‘ ë³€ê²½í•˜ì§€ ì•Šê³ , setXxx, getXxxë¼ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ì„œ ê°’ì„ ì½ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ê·œì¹™ì„ ë§Œë“¤ì—ˆëŠ”ë°,
ê·¸ê²ƒì´ ìë°” ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì´ë‹¤.
```
#### ğŸ’¡ ìë°” ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ ì˜ˆì‹œ
````java
class Data {
    private int age;
    public void setAge(int age) {
        this.age = age; 
    }
  
    public int getAge() {
        return age; 
    }
}
````

### 3. í•„ë“œ ì£¼ì…
- í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ë²•

#### íŠ¹ì§•
- ì½”ë“œê°€ ê°„ê²°í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆì§€ë§Œ, ì™¸ë¶€ì—ì„œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•´ì„œ í…ŒìŠ¤íŠ¸ í•˜ê¸° í˜ë“¤ë‹¤ëŠ” ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ìˆë‹¤.
- DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤.
- `ì‚¬ìš©í•˜ì§€ ë§ì!`
  - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ì½”ë“œì™€ ê´€ê³„ ì—†ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ
  - ìŠ¤í”„ë§ ì„¤ì •ì„ ëª©ì ìœ¼ë¡œ í•˜ëŠ” @Configuration ê°™ì€ ê³³ì—ì„œë§Œ íŠ¹ë³„í•œ ìš©ë„ë¡œ ì‚¬ìš©

````java
@Component
public class OrderServiceImpl implements OrderService {
  @Autowired
  private MemberRepository memberRepository;
  @Autowired
  private DiscountPolicy discountPolicy;
}
````
```
// ì°¸ê³  1
ìˆœìˆ˜í•œ ìë°” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ëŠ” ë‹¹ì—°íˆ @Autowiredê°€ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
`@SpringBootTest`ì²˜ëŸ¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í…ŒìŠ¤íŠ¸ì— í†µí•©í•œ ê²½ìš°ì—ë§Œ ê°€ëŠ¥í•˜ë‹¤.
// ì°¸ê³  2
ì•„ë˜ ì½”ë“œì™€ ê°™ì´ `@Bean`ì—ì„œ íŒŒë¼ë¯¸í„°ì— ì˜ì¡´ ê´€ê³„ëŠ” ìë™ ì£¼ì…ëœë‹¤.
ìˆ˜ë™ ë“±ë¡ ì‹œ ìë™ ë“±ë¡ëœ ë¹ˆì˜ ì˜ì¡´ê´€ê³„ê°€ í•„ìš”í•  ë•Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
```
````java
@Bean
OrderService orderService(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
  new OrderServiceImpl(memberRepository, discountPolicy)
}
````

### 4. ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…
- ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.

#### íŠ¹ì§•
- í•œë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.
- ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

````java
@Component
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````
```
// ì°¸ê³ 
ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ ë™ì‘í•œë‹¤.
ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹Œ `Member`ê°™ì€ í´ë˜ìŠ¤ì—ì„œ `@Autowired` ì½”ë“œë¥¼ ì ìš©í•´ë„ ì•„ë¬´ ê¸°ëŠ¥ë„ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
```

- - -
## âœ” ì˜µì…˜ ì²˜ë¦¬
- ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë•Œê°€ ìˆë‹¤.
- í•˜ì§€ë§Œ `@Autowired`ë§Œ ì‚¬ìš©í•˜ë©´ `required` ì˜µì…˜ì˜ ê¸°ë³¸ê°’ì´ `true`ë¡œ ë˜ì–´ ìˆì–´ì„œ ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

### 1. ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
- `@Autowired(required=false)` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œ ì•ˆë¨
- `org.springframework.lang.@Nullable` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥ëœë‹¤.
- `Optional<>` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ `Optional.empty`ê°€ ì…ë ¥ëœë‹¤.

#### ğŸ’¡ ì˜ˆì œ
- MemberëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹ˆë‹¤.
- `setNoBean1()`ì€ `@Autowired(required=false)`ì´ë¯€ë¡œ í˜¸ì¶œ ìì²´ê°€ ì•ˆëœë‹¤.

````java
// í˜¸ì¶œ ì•ˆë¨
@Autowired(required = false)
public void setNoBean1(Member member) {
    System.out.println("setNoBean1 = " + member); 
}

// null í˜¸ì¶œ
@Autowired
public void setNoBean2(@Nullable Member member) {
    System.out.println("setNoBean2 = " + member);
}

// Optional.empty í˜¸ì¶œ
@Autowired(required = false)
public void setNoBean3(Optional<Member> member) {
    System.out.println("setNoBean3 = " + member);
}
````

#### ğŸ’¡ ì¶œë ¥ ê²°ê³¼
```
setNoBean2 = null
setNoBean3 = Optional.empty
```

```
// ì°¸ê³ 
@Nullable, Optionalì€ ìŠ¤í”„ë§ ì „ë°˜ì— ê±¸ì³ì„œ ì§€ì›ëœë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ì„œ ìƒì„±ì ìë™ ì£¼ì…ì—ì„œ íŠ¹ì • í•„ë“œì—ë§Œ ì‚¬ìš©í•´ë„ ëœë‹¤.
```

- - -
## âœ” ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!
ê³¼ê±°ì—ëŠ” ìˆ˜ì •ì ì£¼ì…ê³¼ í•„ë“œ ì£¼ì…ì„ ë§ì´ ì‚¬ìš©í–ˆì§€ë§Œ, ìµœê·¼ì—ëŠ” ìŠ¤í”„ë§ì„ í¬í•¨í•œ DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥
### 1. ìƒì„±ì ì£¼ì… ê¶Œì¥ ì´ìœ 
#### ğŸ’¡ (1) ë¶ˆë³€
- ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í•œë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œì ê¹Œì§€ ì˜ì¡´ê´€ê³„ë¥¼ ë³€ê²½í•  ì¼ì´ ì—†ë‹¤.
  ì˜¤íˆë ¤ ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì „ê¹Œì§€ ë³€í•˜ë©´ ì•ˆëœë‹¤. `(ë¶ˆë³€í•´ì•¼ í•œë‹¤.)`
- ìˆ˜ì •ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´, setXxx ë©”ì„œë“œë¥¼ publicìœ¼ë¡œ ì—´ì–´ë‘ì–´ì•¼ í•˜ë‚Ÿ.
    - ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ë„ ìˆê³ , ë³€ê²½í•˜ë©´ ì•ˆë˜ëŠ” ë©”ì„œë“œë¥¼ ì—´ì–´ë‘ëŠ” ê²ƒì€ ì¢‹ì€ ì„¤ê³„ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.
- `ìƒì„±ì ì£¼ì…`ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ `ë¶ˆë³€í•˜ê²Œ ì„¤ê³„`í•  ìˆ˜ ìˆë‹¤.

#### ğŸ’¡ (2) ëˆ„ë½
[í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜í•œ ìë°” ì½”ë“œë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²½ìš°] (`@Autowired`ê°€ í”„ë ˆì„ì›Œí¬ ì•ˆì—ì„œ ë™ì‘í•  ë•ŒëŠ” ì˜ì¡´ê´€ê³„ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒ)
- ìˆ˜ì •ì ì˜ì¡´ ê´€ê³„ì¸ ê²½ìš° í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì‹œ ì‹¤í–‰ì€ ë˜ì§€ë§Œ, ì‹¤í–‰ ê²°ê³¼ëŠ” NPE(Null Point Exception) ë°œìƒ
    - memberRepository, discountPolicy ëª¨ë‘ ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ëˆ„ë½ë˜ì—ˆê¸° ë•Œë¬¸
java > hello.core.order > OrderServiceImpl.java
````java
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;
    
    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
    
    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````
test > java > hello.core.order > OrderServiceImplTest.java (class)
````java
package hello.core.order;

import org.junit.jupiter.api.Test;

class OrderServiceImplTest {

    @Test
    void createOrder() {
        OrderServiceImpl orderService = new OrderServiceImpl();
        orderService.createOrder(1L, "itemA", 10000);
    }
}
````
- ì´ë•Œ `ìƒì„±ì ì£¼ì…`ì„ ì‚¬ìš©í•˜ë©´ ì£¼ì… ë°ì´í„°ë¥¼ ëˆ„ë½í–ˆì„ ë•Œ `ì»´íŒŒì¼ ì˜¤ë¥˜`ê°€ ë°œìƒí•œë‹¤.
- ë˜í•œ, IDEì—ì„œ ë°”ë¡œ ì–´ë–¤ ê°’ì„ í•„ìˆ˜ë¡œ ì£¼ì…í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
java > hello.core.order > OrderServiceImpl.java
````java
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) { // ìƒì„±ì ì£¼ì…
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````
test > java hello.core.order > OrderServiceImplTest.java
![ì»´íŒŒì¼ ì˜¤ë¥˜](https://user-images.githubusercontent.com/54324782/215224784-60c8607c-e095-4ddc-873c-0f50ddbd5ee9.png)
````java
package hello.core.order;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemoryMemberRepository;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

class OrderServiceImplTest {

    @Test
    void createOrder() {
        MemoryMemberRepository memberRepository = new MemoryMemberRepository();
        memberRepository.save(new Member(1L, "name", Grade.VIP));

        OrderServiceImpl orderService = new OrderServiceImpl(memberRepository, new FixDiscountPolicy());
        Order order = orderService.createOrder(1L, "itemA", 10000);
        assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
````

#### ğŸ’¡ (3) final í‚¤ì›Œë“œ
- ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í•„ë“œì— `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ê·¸ë˜ì„œ ìƒì„±ìì—ì„œ í˜¹ì‹œë¼ë„ ê°’ì´ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ë§‰ì•„ì¤€ë‹¤.
java > hello.core.order > OrderServiceImpl.java
![image](https://user-images.githubusercontent.com/54324782/215226236-ba117da1-535d-43dd-839b-c879ff421b71.png)

- í•„ìˆ˜ í•„ë“œì¸ `discountPolicy`ì— ê°’ì„ ì„¤ì •í•´ì•¼ í•˜ëŠ”ë°, ëˆ„ë½ë˜ì—ˆë‹¤.
    - ìë°”ëŠ” ì»´íŒŒì¼ ì‹œì ì— ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.
    - `java: variable discountPolicy might not have been initialized`

```
// ì°¸ê³ 
ìˆ˜ì •ì ì£¼ì…ì„ í¬í•¨í•œ ë‚˜ë¨¸ì§€ ì£¼ì… ë°©ì‹ì€ ëª¨ë‘ ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
ì˜¤ì§ ìƒì„±ì ì£¼ì… ë°©ì‹ë§Œ `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
```

### ğŸ’¡ ì •ë¦¬
- ìƒì„±ì ì£¼ì… ë°©ì‹ ì„ íƒ ì´ìœ 
    - í”„ë ˆì„ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.
    - ìˆœìˆ˜í•œ ìë°” ì–¸ì–´ì˜ íŠ¹ì§•ì„ ì˜ ì‚´ë¦°ë‹¤.
- ê¸°ë³¸ì ìœ¼ë¡œ ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ê³ , í•„ìˆ˜ ê°’ì´ ì•„ë‹Œ ê²½ìš°ì—ëŠ” ìˆ˜ì •ì ì£¼ì… ë°©ì‹ì„ ì˜µì…˜ìœ¼ë¡œ ë¶€ì—¬í•˜ë©´ ëœë‹¤.
    - ìƒì„±ì ì£¼ì…ê³¼ ìˆ˜ì •ì ì£¼ì…ì„ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- í•­ìƒ `ìƒì„±ì ì£¼ì…`ì„ ì„ íƒ, ê°€ë” ì˜µì…˜ì´ í•„ìš”í•˜ë©´ `ìˆ˜ì •ì ì£¼ì…`ì„ ì„ íƒ, `í•„ë“œ ì£¼ì…`ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤.


- - -
## âœ” ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ë Œë“œ
- ë¡¬ë³µ(Lombok) : ìë°”ì— Getter, Setter ë©”ì†Œë“œ ë“±ì„ ë§Œë“¤ì–´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
### 1. ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ìš©
#### (1) build.gradleì— ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° í™˜ê²½ ì¶”ê°€
````gradle
plugins {
	id 'java'
	id 'org.springframework.boot' version '2.7.6'
	id 'io.spring.dependency-management' version '1.0.15.RELEASE'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '11'

// lombok ì„¤ì • ì¶”ê°€ start
configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}
// lombok ì„¤ì • ì¶”ê°€ end

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter'
	
	// lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ start
	compileOnly 'org.projectlombok:lombok'
	annotationProcessor 'org.projectlombok:lombok'
	
	testCompileOnly 'org.projectlombok:lombok'
	testAnnotationProcessor 'org.projectlombok:lombok'
	// lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ end
	
	testImplementation ('org.springframework.boot:spring-boot-starter-test') {
		exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'
	}
}

tasks.named('test') {
	useJUnitPlatform()
}
````
#### (2) Lombok Plugin ì„¤ì¹˜
File > Settings > Plugins
![image](https://user-images.githubusercontent.com/54324782/215227927-67f4131e-ae44-4b0c-b573-2dfc60cc6679.png)

#### (3) Annotation Processing í™œì„±í™”
File > Settings > Build, Execution, Deployment > Compiler > Annotation Processors > Enable annotation processing
![image](https://user-images.githubusercontent.com/54324782/215228155-e05ddaf2-6cc5-4414-a2cc-13ac6c133cd6.png)

#### (4) ì„ì˜ì˜ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³  @Getter, @Setter í™•ì¸
java > hello.core > HelloLombok.java (class)
````java
package hello.core;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class HelloLombok {
    private String name;
    private int age;

    public static void main(String[] args) {
        HelloLombok helloLombok = new HelloLombok();
        helloLombok.setName("hahaha");

        String name = helloLombok.getName();
        System.out.println("name = " + name); // ì¶œë ¥: name = hahaha
    }
}
````

### 2. ë¡¬ë³µ(lombok) ì ìš©
java > hello.core.order > OrderServiceImpl.java
#### (1) @Autowired ìƒëµ
ìƒì„±ìê°€ ë”± 1ê°œë§Œ ìˆìœ¼ë©´ `@Autowired`ë¥¼ ìƒëµí•  ìˆ˜ ìˆë‹¤.
````java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) { // ìƒì„±ì ì£¼ì…
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````

#### (2) ìƒì„±ì ìë™ ìƒì„±
- ë¡¬ë³µ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” `@RequiredArgsConstructor` ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ `final`ì´ ë¶™ì€ í•„ë“œë¥¼ ëª¨ì•„ì„œ `ìƒì„±ìë¥¼ ìë™`ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.
    - ì¦‰, ë¡¬ë³µì´ ìë°”ì˜ ì–´ë…¸í…Œì´ì…˜ í”„ë¡œì„¸ì„œ ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ ì»´íŒŒì¼ ì‹œì ì— ìƒì„±ì ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤€ë‹¤.
    - ì½”ë“œì—ëŠ” ë³´ì´ì§€ ì•Šì§€ë§Œ ì‹¤ì œ í˜¸ì¶œ ê°€ëŠ¥í•˜ë‹¤.

````java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Component;

@Component
@RequiredArgsConstructor
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;
    
    // ìƒì„±ì ì½”ë“œ ì œê±° -> ì½”ë“œ ê°„ê²°
    .
    .
}
````

### ğŸ’¡ ì •ë¦¬
- ìµœê·¼ì—ëŠ” ìƒì„±ìë¥¼ ë”± 1ê°œ ë‘ê³ , `@Autowired`ë¥¼ ìƒëµí•˜ëŠ” ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.
- ì—¬ê¸°ì— `Lombok ë¼ì´ë¸ŒëŸ¬ë¦¬`ì˜ `@RequiredArgsConstructor` í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ê¸°ëŠ¥ì€ ë‹¤ ì œê³µí•˜ë©´ì„œ, ì½”ë“œëŠ” ê¹”ë”í•´ì§„ë‹¤.


- - - 
## âœ” ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ
````java
@Autowired
private DiscountPolicy discountPolicy
````
- @AutowiredëŠ” íƒ€ì…(Type)ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.
  - íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•˜ê¸° ë•Œë¬¸ì—, `ac.getBean(DiscountPolicy.class)` ì½”ë“œì™€ ìœ ì‚¬í•˜ê²Œ ë™ì‘í•œë‹¤. (ì‹¤ì œë¡œëŠ” ë” ë§ì€ ê¸°ëŠ¥ì„ ì œê³µ)
- íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•˜ë©´ ì„ íƒëœ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

### 1. ìŠ¤í”„ë§ ë¹ˆ ì„ ì–¸
- `DiscountPolicy`ì˜ í•˜ìœ„ íƒ€ì…ì„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì„ ì–¸
  - FixDiscountPolicy, RateDiscountPolicy

````java
@Component
public class FixDiscountPolicy implements DiscountPolicy {}
````
````java
@Component
public class RateDiscountPolicy implements DiscountPolicy {}
````

### 2. ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…
````java
@Autowired
private DiscountPolicy discountPolicy
````

### 3. NoUniqueBeanDefinitionException ì˜¤ë¥˜ ë°œìƒ
```
// fixDiscountPolicy, rateDiscountPolicy ê°€ ë°œê²¬ë˜ì—ˆë‹¤ê³  ì•Œë ¤ì¤€ë‹¤.
NoUniqueBeanDefinitionException: No qualifying bean of type 'hello.core.discount.DiscountPolicy' available: 
expected single matching bean but found 2: fixDiscountPolicy,rateDiscountPolicy
```
- ì´ë•Œ í•˜ìœ„ íƒ€ì…ìœ¼ë¡œ ì§€ì •í•  ìˆ˜ë„ ìˆì§€ë§Œ, í•˜ìœ„ íƒ€ì…ìœ¼ë¡œ ì§€ì •í•˜ëŠ” ê²ƒì€ DIPë¥¼ ìœ„ë°°í•˜ê³  ìœ ì—°ì„±ì´ ë–¨ì–´ì§„ë‹¤.
- ë˜í•œ, ì´ë¦„ë§Œ ë‹¤ë¥´ê³ , ì™„ì „íˆ ë˜‘ê°™ì€ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ 2ê°œ ìˆì„ ë•Œ í•´ê²°ì´ ì•ˆëœë‹¤.
- ìŠ¤í”„ë§ ë¹ˆì„ ìˆ˜ë™ ë“±ë¡í•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í•´ë„ ë˜ì§€ë§Œ, ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ì—ì„œ í•´ê²°í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆë‹¤.

- - -
## âœ” @Autowired í•„ë“œ ëª…, @Qualifier, @Primary
- ì¡°íšŒ ëŒ€ìƒ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ í•´ê²° ë°©ë²• (3ê°€ì§€)
  - @Autowired í•„ë“œ ëª… ë§¤ì¹­
  - @Qualifier -> @Qualifierë¼ë¦¬ ë§¤ì¹­ -> ë¹ˆ ì´ë¦„ ë§¤ì¹­
  - @Primary ì‚¬ìš©

### 1. @Autowired í•„ë“œ ëª… ë§¤ì¹­
- `@Autowired`ëŠ” íƒ€ì… ë§¤ì¹­ì„ ì‹œë„í•˜ê³ , ì´ë•Œ ì—¬ëŸ¬ ë¹ˆì´ ìˆìœ¼ë©´ í•„ë“œ ì´ë¦„ì´ë‚˜ íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë¹ˆ ì´ë¦„ì„ ì¶”ê°€ ë§¤ì¹­í•œë‹¤.
- í•„ë“œ ëª… ë§¤ì¹­ì€ ë¨¼ì € íƒ€ì… ë§¤ì¹­ì„ ì‹œë„ í•˜ê³ , ê·¸ ê²°ê³¼ì— ì—¬ëŸ¬ ë¹ˆì´ ìˆì„ ë•Œ ì¶”ê°€ë¡œ ë™ì‘í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.

#### ê¸°ì¡´ ì½”ë“œ
java > hello.core.order > OrderServiceImpl.java
````java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
    .
    .
}
````

#### í•„ë“œ ëª…ì„ ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë³€ê²½
````java
@Component
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy rateDiscountPolicy) { // í•„ë“œ ëª…ì´ rateDiscountPolicy ì´ë¯€ë¡œ ì •ìƒ ì£¼ì…ëœë‹¤.
        this.memberRepository = memberRepository;
        this.discountPolicy = rateDiscountPolicy;
    }
    .
    .
}
````

#### Test ê²°ê³¼
test > java >hello.core.scan > AutoAppConfigTest.java
````java
package hello.core.scan;

import hello.core.AutoAppConfig;
import hello.core.member.MemberRepository;
import hello.core.member.MemberService;
import hello.core.order.OrderServiceImpl;
import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import static org.assertj.core.api.Assertions.*;

public class AutoAppConfigTest {
    @Test
    void basicScan() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class);
        MemberService memberService = ac.getBean(MemberService.class);
        assertThat(memberService).isInstanceOf(MemberService.class);

        OrderServiceImpl bean = ac.getBean(OrderServiceImpl.class);
        MemberRepository memberRepository = bean.getMemberRepository();
        System.out.println("memberRepository = " + memberRepository);
    }
}
````
![image](https://user-images.githubusercontent.com/54324782/215232720-75992edd-5702-4f54-a669-ba5f1eabbb01.png)

### ğŸ’¡ @Autowired ë§¤ì¹­ ì •ë¦¬
- íƒ€ì… ë§¤ì¹­
- íƒ€ì… ë§¤ì¹­ì˜ ê²°ê³¼ê°€ 2ê°œ ì´ìƒì¼ ë•Œ í•„ë“œ ëª…, íŒŒë¼ë¯¸í„° ëª…ìœ¼ë¡œ ë¹ˆ ì´ë¦„ ë§¤ì¹­


### 2. Qualifier ì‚¬ìš©
- `@Qualifier`ëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•
- ì£¼ì… ì‹œ ì¶”ê°€ì ì¸ ë°©ë²•ì„ ì œê³µí•˜ëŠ” ê²ƒì´ì§€, ë¹ˆ ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

#### ë¹ˆ ë“±ë¡ ì‹œ @Qualifierë¥¼ ë¶™ì—¬ ì¤€ë‹¤.
java > hello.core.discount > RateDiscountPolicy.java
````java
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy {}
````
java > hello.core.discount > FixDiscountPolicy.java
````
@Component
@Qualifier("fixDiscountPolicy")
public class FixDiscountPolicy implements DiscountPolicy {}
````

#### ìƒì„±ì ìë™ ì£¼ì…
- ì£¼ì… ì‹œì— @Qualifierë¥¼ ë¶™ì—¬ì£¼ê³  ë“±ë¡í•œ ì´ë¦„ì„ ì ì–´ì¤€ë‹¤.
java > hello.core.order > OrderServiceImpl.java
````java
@Autowired
public OrderServiceImpl(MemberRepository memberRepository, @Qualifier("mainDiscountPolicy") DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
````

```
// ì°¸ê³ 
@Qualifierë¡œ ì£¼ì…í•  ë•Œ `@Qualifier("mainDiscountPolicy")`ë¥¼ ëª»ì°¾ìœ¼ë©´, mainDiscountPolicyë¼ëŠ” ì´ë¦„ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ì¶”ê°€ë¡œ ì°¾ëŠ”ë‹¤.
í•˜ì§€ë§Œ, @QualifierëŠ” @Qualifierë¥¼ ì°¾ëŠ” ìš©ë„ë¡œë§Œ ì‚¬ìš©í•˜ëŠ”ê²Œ ëª…í™•í•˜ê³  ì¢‹ë‹¤.
```

#### ì¶”ê°€
- ì§ì ‘ ë¹ˆ ë“±ë¡ ì‹œì—ë„ @Qualifierë¥¼ ë™ì´ë—ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
````java
@Bean
@Qualifier("mainDiscountPolicy")
public DiscountPolicy discountPolicy() {
    return new ...
}
````

### @Qualifier ì •ë¦¬
- @Qualifierë¼ë¦¬ ë§¤ì¹­
- ë¹ˆ ì´ë¦„ ë§¤ì¹­
- `NoSuchBeanDefinitionException` ë°œìƒ

### 3. @Primary ì‚¬ìš©
- `@Primary`ëŠ” ìš°ì„ ìˆœìœ„ë¥¼ ì •í•˜ëŠ” ë°©ë²•
- @Autowired ì‹œì— ì—¬ëŸ¬ ë¹ˆì´ ë§¤ì¹­ë˜ë©´ @Primaryê°€ ìš°ì„ ê¶Œì„ ê°€ì§„ë‹¤.
````java
@Component
@Primary // rateDiscountPolicyê°€ ìš°ì„ ê¶Œì„ ê°€ì§„ë‹¤.
public class RateDiscountPolicy implements DiscountPolicy {}

@Component
public class FixDiscountPolicy implements DiscountPolicy {}
````
java > hello.core.order > OrderServiceImpl.java
````java
@Autowired
public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
````

#### @Primary vs @Qualifier
- @Qualifierì˜ ë‹¨ì ì€ ì£¼ì… ë°›ì„ ë•Œ ëª¨ë“  ì½”ë“œì— @Qualifierë¥¼ ë¶™ì—¬ì£¼ì–´ì•¼ í•œë‹¤.
- ë°˜ë©´ì— @Primaryë¥¼ ì‚¬ìš©í•˜ë©´ @Qualifierë¥¼ ë¶™ì¼ í•„ìš”ê°€ ì—†ë‹¤.

#### ğŸ’¡ @Primary, @Qualifier í™œìš©
- ì½”ë“œì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìˆê³ ,
- ì½”ë“œì—ì„œ íŠ¹ë³„í•œ ê¸°ëŠ¥ìœ¼ë¡œ ê°€ë” ì‚¬ìš©í•˜ëŠ” ì„œë¸Œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ,
- ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì»¤ë„¥ì…˜ì„ íšë“í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì€ `@Primary`ë¥¼ ì ìš©í•´ì„œ ì¡°íšŒí•˜ëŠ” ê³³ì—ì„œ `@Qualifier` ì§€ì • ì—†ì´ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•˜ê³ 
- ì„œë¸Œ ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ ë¹ˆì„ íšë“í•  ë•ŒëŠ” `@Qualifier`ë¥¼ ì§€ì •í•´ì„œ `ëª…ì‹œì ìœ¼ë¡œ` íšë“í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ì½”ë“œë¥¼ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
- ì´ë•Œ ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•  ë•Œ `@Qualifier`ë¥¼ ì§€ì •í•´ì£¼ëŠ” ê²ƒì€ ìƒê´€ì—†ë‹¤.

#### ğŸ’¡ @Primary vs @Qualifier ìš°ì„  ìˆœìœ„
- @PrimaryëŠ” ê¸°ë³¸ ê°’ì²˜ëŸ¼ ë™ì‘
- @QualifierëŠ” ë§¤ìš° ìƒì„¸í•˜ê²Œ ë™ì‘
- ìŠ¤í”„ë§ì€ ìë™ë³´ë‹¤ëŠ” ìˆ˜ë™ì´, ë„“ì€ ë²”ìœ„ì˜ ì„ íƒê¶Œ ë³´ë‹¤ëŠ” ì¢ì€ ë²”ìœ„ì˜ ì„ íƒê¶Œì´ ìš°ì„  ìˆœìœ„ê°€ ë†’ë‹¤.
- ë”°ë¼ì„œ, `@Qualifier`ê°€ ìš°ì„ ê¶Œì´ ë†’ë‹¤.


- - -
## âœ” ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°
- `@Qualifier("mainDiscountPolicy")`ì™€ ê°™ì´ ë¬¸ìë¥¼ ë„£ìœ¼ë©´ ì»´íŒŒì¼ ì‹œ íƒ€ì… ì²´í¬ê°€ ì•ˆëœë‹¤.
- ì–´ë…¸í…Œì´ì…˜ì„ ì§ì ‘ ë§Œë“¤ì–´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
java > hello.core.annotation > MainDiscountPolicy.java (annotation)
````java
package hello.core.annotation;

import org.springframework.beans.factory.annotation.Qualifier;

import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {
}
````
java > hello.core.discount > RateDiscountPolicy.java
````java
@Comonent
@MainDiscountPolicy
public class RateDiscountPolicy implements DiscountPolicy {}
````
java > hello.core.order > OrderServiceImpl.java
````java
@Autowired
public OrderServiceImpl(MemberRepository memberRepository, @MainDiscountPolicy DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
````

- - -
## âœ” ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map
- ì˜ë„ì ìœ¼ë¡œ ì •ë§ í•´ë‹¹ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ë‹¤ í•„ìš”í•œ ê²½ìš°ë„ ìˆë‹¤.
  - ex. í• ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ”ë°, í´ë¼ì´ì–¸íŠ¸ê°€ í• ì¸ì˜ ì¢…ë¥˜(rate, fix)ë¥¼ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê²½ìš°

test > java > hello.core.autowired > AllBeanTest
````java
package hello.core.autowired;

import hello.core.AutoAppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;

public class AllBeanTest {
    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "userA", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000, "fixDiscountPolicy");

        Assertions.assertThat(discountService).isInstanceOf(DiscountService.class);
        Assertions.assertThat(discountPrice).isEqualTo(1000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);

            System.out.println("discountCode = " + discountCode);
            System.out.println("discountPolicy = " + discountPolicy);

            return discountPolicy.discount(member, price);
        }
    }
}
````
![image](https://user-images.githubusercontent.com/54324782/215235525-970e93f9-83bc-44e3-9a25-123e567ee64e.png)

```
// ì¶œë ¥
policyMap = {fixDiscountPolicy=hello.core.discount.FixDiscountPolicy@4351c8c3, rateDiscountPolicy=hello.core.discount.RateDiscountPolicy@3381b4fc}
policies = [hello.core.discount.FixDiscountPolicy@4351c8c3, hello.core.discount.RateDiscountPolicy@3381b4fc]
.
.
discountCode = fixDiscountPolicy
discountPolicy = hello.core.discount.FixDiscountPolicy@4351c8c3
```

### 1. ë¡œì§ ë¶„ì„
- DiscountServiceëŠ” Mapìœ¼ë¡œ ëª¨ë“  `DiscountPolicy`ë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤. ì´ë•Œ `fixDiscountPolicy`, `rateDiscountPolicy`ê°€ ì£¼ì…ëœë‹¤.
- `discount () ë©”ì„œë“œ`ëŠ” discountCodeë¡œ "fixDiscountPolicy"ê°€ ë„˜ì–´ì˜¤ë©´ mapì—ì„œ `fixDiscountPolicy` ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‹¤í–‰í•œë‹¤.
  - ë¬¼ë¡  "rateDiscountPolicy"ê°€ ë„˜ì–´ì˜¤ë©´ `rateDiscountPolicy` ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‹¤í–‰í•œë‹¤.

### 2. ì£¼ì… ë¶„ì„
- `Map<String, DiscountPolicy>`: mapì˜ keyì— ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ê³ , ê·¸ ê°’ìœ¼ë¡œ `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤€ë‹¤.
- `List<DiscountPolicy>`: `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤€ë‹¤.
- ë§Œì•½ í•´ë‹¹í•˜ëŠ” íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´, ë¹ˆ ì»¬ë ‰ì…˜ì´ë‚˜ Mapì„ ì£¼ì…í•œë‹¤.

```
// ì°¸ê³  - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ì„œ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±ìì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤. ì—¬ê¸°ì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë„˜ê¸°ë©´ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
`new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class)`

ì´ ì½”ë“œëŠ” 2ê°€ì§€ë¡œ ë‚˜ëˆ„ì–´ ì´í•´í•  ìˆ˜ ìˆë‹¤.
`new AnnotationConfigApplicationContext()`ë¥¼ í†µí•´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•œë‹¤.
`AutoAppConfig.class, DiscountService.class`ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ë©´ì„œ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤.

ì •ë¦¬í•˜ë©´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ì„œ, í•´ë‹¹ ì»¨í…Œì´ë„ˆì— ë™ì‹œì— `AutoAppConfig`, `DiscountService`ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡í•œë‹¤.
```

- - -
